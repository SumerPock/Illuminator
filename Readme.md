### 激光照射器协议



#### 功能
1.数据协议转发模式
2.内同步普通编码模式
3.内同步伪随机编码模式
4.继电器控制

#### 协议内容
接口类型：RJ45接口
接口协议：UDP
服务器IP地址：192.169.0.120
服务器端口号：80
客户端IP地址：192.168.0.240
客户端端口号：80

其中多字节传输时数据先低后高
| 类型 | 含义 | 占用空间 | 取值范围 | 备注 |
| :------ | :------ | :--------: | :--- | :--------: |
| 长度     |         | 1Byte   | 0-65535     |
| ID      |  具体功能区分|  1Byte  | 0 - f     |
| 子ID      |  具体功能区分|  1Byte  | 0 - f     |
| 具体数据  | 见一下具体功能| xByte   |          |
| CRC校验  | CRC16校验| 2Byte| 0 -65535       |

#### 数据协议转发模式
网口数据与串口数据相互透传,此板卡只负责二次打包数据,其余全部交给上位机处理

#### 内同步普通编码模式
##### 装订指令
| 含义     | 举例 | 占用空间 | 取值范围 | 比例尺 | 备注  |
| :------- | :------------- | :------: | :------- | :------- | :---: |
| ID       | 0X02       |  Uchat    |  0 - f   |
| 子ID     |  0X00      |  Uchat    |   0 - f  |
| 脉冲数    | 0x64      | Short      | -1~1000|1Byte = 1次脉冲|其中：-1代表无限次,0无意义, |
| 周期     | 0xC350    |  UShort   |1.000~30.000ms|1Byte = 0.01ms|当具体内容1设置关闭时,此内容无效|

##### 控制指令
| 含义  | 举例     | 占用空间 | 取值范围       |     比例尺 |                 备注                       |
| :----   | :------- | :------: | :------------- |:------- | :---------------------------------------------: |
| ID      | 0X02     |  Uchat   | 0 - f              |
| 子ID    | 0X01     |  Uchat   | 0 - f              |
| 脉冲状态 | 0x01     |  Uchat   | 1 ~ 2        |   其中：1：开启 , 2：关闭|

##### 查询指令
下发此指令后，单片机会返回查询的具体数据类型
| 含义 | 举例     | 占用空间 | 取值范围 |        比例尺 |       备注            |
| :--- | :-------  | :------: | :------- | :------- |:------------------------: |
| ID   | 0X02      |  1Byte   |  0 - f      |
| 子ID | 0X02      |  1Byte   |  0 - f      |
| 内容 | 具体类型数据 |  1Byte   | 0-f| 1：脉冲数 2：周期 3：脉冲状态，F全部返回 |



#### 内同步伪随机编码模式
##### 装订指令
| 含义 | 举例 | 占用空间 | 取值范围 | 比例尺 | 备注  |
| :--- | :--- | :------: | :------- |:------- | :---: |
| ID            | 0X04      |  Uchat   |  0 - f        |
| 子ID           | 0X00    |  Uchat   |   0 - f       |
| 伪随机编码总数    | 0x64   |  Ushort   |    0 - 2048    |  |
| 伪随机编码单前索引 |  0x01  |  Ushort   |    0 - 2048      |  |
| 伪随机编码值      |  0xc350|  Ushort   |     1.000 - 30.000      |  |

##### 控制指令
| 含义        | 举例      | 占用空间 | 取值范围 | 比例尺 |         备注           |
| :---------- | :-------- | :------: | :------- | :------- |:---------------------: |
| ID          | 0X04      |  Uchat   |    0 - f  |
| 子ID         | 0X01      |  Uchat   |    0 -f   |
| 伪随机编码指定 | 0x01      |  Uchat   |    1 - 2   |  |目前只考虑了2组|
| 伪随机开/关   | 0x01      |  Uchat   |    1 - 2   |  |1:代表开启  2：代表关闭|


##### 查询指令
查询指令下发后单片机将返回 伪随机编码总数 伪随机编码当前索引 伪随机编码值
| 含义         | 举例      | 占用空间 | 取值范围 |   比例尺 |        备注           |
| :---------  | :-------- | :------: | :------- |:------- | :---------------------: |
| ID           | 0X03      |  Uchat   |  0 - f   |
| 子ID         | 0X02      |  Uchat   |   0 - f   |
| 查询第几组伪随机数据| 0X01      |  Uchat   |  1 - 2 ||目前只考虑了2组|






